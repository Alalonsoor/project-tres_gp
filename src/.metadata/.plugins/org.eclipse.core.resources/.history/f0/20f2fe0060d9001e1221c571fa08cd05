package gp.commands;


import java.io.FileNotFoundException;
import java.io.IOException;
import gp.logic.Game;
import gp.logic.InitializationException;
import gp.view.Messages;

public class ResetCommand extends Command{
	public InitialConfiguration conf;
	
	public ResetCommand() {
		this.conf = InitialConfiguration.NONE;
	}
	
	protected ResetCommand(InitialConfiguration conf) {
		this.conf=conf;
	}

	@Override
	protected String getName() {
		return Messages.COMMAND_RESET_NAME;
	}

	@Override
	protected String getShortcut() {
		return Messages.COMMAND_RESET_SHORTCUT;
	}

	@Override
	protected String getDetails() {
		return Messages.COMMAND_RESET_DETAILS;
	}

	@Override
	protected String getHelp() {
		return Messages.COMMAND_RESET_HELP;
	}

	@Override
	public boolean execute(GameModel game) throws CommandExecuteException {
		try {
			game.reset(conf);
		} catch (InitializationException e) {
			throw new CommandExecuteException(Messages.INITIAL_CONFIGURATION_ERROR, e);
		}
		return true;
	}
	@Override
	public Command parse(String[] commandWords) throws CommandParseException {
		try {
	        if (commandWords.length > 1) {
	            InitialConfiguration config = InitialConfiguration.readFromFile(commandWords[1]);
	            return new ResetCommand(config);
	        } else {
	        	return new ResetCommand();
	        }	        
	    } catch (IOException e) {
			String s = String.format(Messages.FILE_NOT_FOUND, commandWords[1]);
	        throw new CommandParseException(s,e);
	    }
	}
}
